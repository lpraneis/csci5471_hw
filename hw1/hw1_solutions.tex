\documentclass[11pt]{article}
\usepackage{fullpage}
\usepackage{amsmath}
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{algpseudocode}
\usepackage{amssymb}
\usepackage{url}
\usepackage{hyperref}

\usepackage{amsfonts}
\usepackage{fancyhdr}
\newcounter{qnum}
\newcommand{\question}[1]{\stepcounter{qnum}\bigskip\noindent{\bf \arabic{qnum}. #1.}}
\newcommand{\E}{\mathop{\textrm{E}}}
\newcommand{\cM}{\mathcal{M}}
\newcommand{\cA}{\mathcal{A}}
\newcommand{\bbM}{\mathbb{M}}
\newcommand{\bbK}{\mathbb{K}}
\newcommand{\X}{\mathbb{X}}
\newcommand\NetIDa{prane001}          
% \newcommand\NetIDb{collab?}          
% \newcommand\NetIDc{collab?}          

%Bibliography
\usepackage{biblatex}
\bibliography{References.bib}
% \addbibresource{References.bib}


\begin{document}
\begin{center}
  {\Large \bf CSci 5471: Modern Cryptography}
\end{center}
{\bf Homework 1} \hfill {\bf due: February 21, 2019}
\newline
{\bf \NetIDa} \hfill  
\medskip
\hrule
\medskip

\question{Number Theory I}
\begin{itemize}
  \item[(a)]   
    First, we are given the polynomial, $n^{3}  + (n+1)^{3} + (n+2)^{3}$, from which we can 
    simplify  to $3 x^{3} + 9 x^{2} + 15 x + 9$. In order to prove that each polynomial is
    divisible by 9, we are proving that $\forall x \in \mathbb{N},  \exists n \in \mathbb{N}$, 
    $9* n =  3 x^{3} + 9 x^{2} + 15 x + 9$. We can simplify this down to
    $3* n =   x^{3} + 3 x^{2} + 5 x + 3$. In order to prove that this holds, we have to prove 
    that $\forall x \in \mathbb{N},  3 \mid x^{3} + 3x^{2} + 5x + 3$. Proving that 
    $3 \mid 3x^{2} + 3$ is trivial, so we are left with proving $3 \mid x^{3} + 5x$. We can factor
    this to $3 \mid x(x^{2} + 5)$. Now, we are left with 2 cases to prove that this statement
    holds $\forall x \in \mathbb{N}$. 
    \newline \textit{Case 1:} $3\mid x$. Since $3\mid x$, $3 \mid x(x^{2} + 5)$ and so we are done.
    \newline \textit{Case 2:} $3\nmid x$. We can prove that $3\mid x^{2} + 5$ using 
    Fermat's Little Theorem. Because 3 is prime and $x^{2} = x^{3-1}$ in addition to knowing
    that $x \not \equiv 0 \pmod{3}$, we know 
    $x^{2} \equiv 1 \pmod{3}$, and thus, $(x^{2} + 5) \pmod{3} = 0$ as $6 \equiv 0 \pmod{3}$. 
    \newline Thus, we have proved that $\forall x \in \mathbb{N}$, $9 \mid n^{3}  + (n+1)^{3} +
    (n+2)^{3}$
  \item[(b)]
    In order to prove that $2^{n} -1 \in \mathbb{P} \rightarrow n \in \mathbb{P}$, we are going to 
    prove the contrapositive: If $n$ is composite, then $2^{n} -1$ is composite. In order to prove
    this, let's first rewrite $2^{n} -1$ as follows: $2^{ab} -1$ for $a,b \in \mathbb{N}$. 
    We can then rewrite $2^{ab} -1$ as $(2^{a} -1) * (2^{a(b-1)} + 2^{a(b-2)} +
    \dots + 2^{a} + 1)$. If $n$ is composite, it implies that $\exists a \in \mathbb{N}$ where
    $a \neq n$ and $a \neq 1$. Thus, due to our factorization, this shows there exists a factor
    of $2^{ab} -1$ that is $(2^{a} -1) \not \in \{2^{ab} -1 , 1\}$, and therefore is composite. 
    By proving the contrapositive of this statement, we have proven the original statement.
  \item[(c)]
    Let us proceed with a proof by contradiction. Let us assume that $4 \mid (n^{2} + 2)$. This
    means that there exists a $x$ such that $4x = n^{2} +2$. Now, let us consider the
    cases: n is even or odd. 
    \newline \textit{n is even}: If n is even, we can express it as $n=2k$ for $k\in \mathbb{N}$
    This means that $4x = (2k)^{2} +2 \Rightarrow 4x = 4k^{2} +2$. If we divide by 2, this
    simplifies to $2x = 2k^{2} +1$, which makes the RHS odd and the LHS even.
    Thus, we have a contradiction.
    \newline \textit{n is odd}: If n is odd, we can express it as $n=2l +1$ for $l \in \mathbb{N}$.
    This means that $4x = (2l+1)^{2} +2 \Rightarrow 4x = 4l^{2} + 4l + 3$. We can rearrange this
    equation to yield the expression $4x  = 2(2l^{2} + 2l + 1) +1$. Again, the RHS is odd and the 
    LHS is even, marking a condition.
    \newline Because the even-odd parity is exhaustive for natural numbers, and in both cases
    we have proved a contradiction, we have proven that: $\forall n \in \mathbb{N}, 
    4 \not| n^{2} + 2$
  \item[(d)]
    We are set to prove that the following equivalence holds true: (odd $-$ even) $\equiv$ number 
    $\pmod{11}$. Let us consider an n-digit number such that $ N = a_{n} + 10a_{n-1} + 10^{2}
    a_{n-2} + \cdots + 10^{n-1}a_{1}$ where $\{ a_{1}, \cdots, a_{n}\}$ are the coefficients. If
    $ 11 | N$, then $N \equiv 0 \pmod{11}$ by the definition of modular equivalence. This means,
    by definition of $N$, that  $a_{n} + 10a_{n-1} + 10^{2}+  a_{n-2} + \cdots + 10^{n-1}a_{1} 
    \equiv 0 \pmod{11}$. Now, in order to prove the statement, we first introduce a Lemma that 
    $10^{x} \equiv (-1)^{x} \pmod {11}$ for any x. We can prove this quickly by considering that 
    $10$ and $-1$ are in the same equivalence class of $\mathbb{Z}_{11}$ as $11 | (10 + 1)$, thus 
    the class is closed under multiplication. Thus, we can rewrite $N$ as 
    $ N = a_{n} - a_{n-1} + a_{n-2} - a_{n-3} + \cdots - (-1)^{n-1}a_{1} \pmod{0}$ which is simply
    the representation of the even coefficients minus the odd coefficients.\cite{AOPS}
  \item[(e)] 
    If $n > 1$ is an integer and not prime, we must show that there is a prime such that:
    $p|n$ and $p \leq \sqrt{n}$. The first condition, that $p|n$, is given by the fundamental 
    theorem of arithmetic:
    For any number $>$ 1, n must itself be a prime number, thus $p|n$ or n must be expressed
    as the unique factorization of primes, in which case, there exits a $p$ such that $p|n$
    The second part, $p \leq \sqrt{n}$ is proved as follows. If $n$ is not prime and greater
    than 1, let it be expressed $n = xy$ where $1 < x \leq y$. Let $x$ be chosen such that 
    $p | x$. This means that $p \leq x \leq y$ and thus, $p^{2} \leq x^{2}\leq xy$.
    This means that $p \leq \sqrt{xy} = \sqrt{n}$ and thus both parts of the 
    statement are proven.
  \item[(f)] 
    We are given that $a^{h} \equiv 1 \pmod{p}$, which is equivalent to $p | (a^{h} -1)$.
    Thus, $\exists x: px = (a^{h} - 1) \rightarrow (px+1) = a^{h}$. If we raise both sides to 
    p, $(px+1)^{p} = a^{ph}$. Using binomial expansion, we can express this as the following:
    \[
      (px+1)^{p} = a^{ph} = 1 + xp^{2} + \sum_{k=2}^{p} \binom{p}{k} (xp)^{k}
    \]
    This equation shows, that every term other than $1$ is divisible by $p^{2}$. Thus, 
    $ p^{2} | (a^{ph} -1)$ and so, $a^{ph} \equiv 1 \pmod{p^{2}}$.
\end{itemize}

\question{Probability exercises} 
\begin{itemize}
  \item[(a)] 
    Given a set $X_1, \dots, X_n$ over the range $\{0,1,\dots,k-1\}$, there are $k$ distant 
    possibilities for each $X_i$. Thus, the probability that $X_i \neq X_{i+1}$ for a given $i$ is:
    \[
      1 - \frac{1}{k} \rightarrow \frac{k-1}{k}
    \]
    However, this probability is for a single $i$ pair. For the $n-1$ pairs in the set of events, $X$,
    we must multiply this probability by the $n-1$ choices and so the final probability becomes:
    \[
      \Pr[X_i \neq X_{i+1} \forall i: 1\leq i < n] =\Big(\frac{k-1}{k}\Big)^{n-1}
    \]
  \item[(b)]
    We are given the inequality: $\Pr[X > k \cdot \E[X]]  \leq \frac{1}{k}$. For sake of 
    proof, let $t = k\E[X]$. The proof is as follows:
    \begin{align}
      &\Pr[x > \frac{t}{\E[X]} \cdot \E[X]] \leq \frac{\E[X]}{t} \\
      &\Pr[x > t] \leq \frac{\E[X]}{t} 
    \end{align}
    If we consider $x \in S$, we can write the expectation as:
    \begin{gather}
    \E[X] = \sum_{x \in S} s \cdot \Pr[X=s], \\
    \geq \sum_{x \in S, x \leq t} 0 \cdot \Pr[X=s] + \sum_{x \in S, x > t} s \cdot \Pr[X=s] \\
    = s \cdot \Pr[X > t] \geq t \cdot \Pr[X > t] \text{ as $s > t$ for all $X$}
  \end{gather}
  And thus the proof is complete.
  \item[(c)] 
    We can use the Bonferroni Inequality \cite{BPS} here to prove this probability. 
      \begin{align}
      & \Pr[A] \leq \Pr[A|B] + \Pr[\bar{B}] \\   
      & \Pr[A] \leq \Pr[A|B] + 1 - \Pr[B] \text{ by definition of complement} \\
      & \Pr[A] + \Pr[B] + 1 \leq \frac{\Pr[A\cap B]}{\Pr[B]} \\
      & \Pr[A] + \Pr[B] -1 = \Pr[A \cap B] \text{ by Bonferroni Inequality} \\
      \text{Because } 0 \leq \Pr[B] \leq 1&, \nonumber \\
      &\Pr[A \cap B] \leq \frac{\Pr[A \cap B]}{\Pr[B]} \\
      \end{align}
      \text{ And thus the inequality is proven.} \nonumber
  \item[(d)]
    %TODO
    We can prove the union bound using Markov's Inequality. Let $E_1, E_2, \dots, E_i$ be
    events and let $\X$ be the number of events that occur. Using the definition of 
    expectation, we know $\E[\X] = \sum_{i=1}^{n} \Pr[\X_i]$. Additionally, using Markov's 
    Inequality, $\Pr[\X \geq 1] \leq \E[\X] $. By the definition of union, we have that 
    $\Pr[\X \geq 1] = \Pr[\bigcup_{i=1}^{n} E_i]$, thus the proof is complete.
  \item[(e)]
    %TODO
  \item[(f)]
    %TODO
\end{itemize}

\question{Identification and Key Exchange Protocols} 
\begin{itemize}
  \item[(a)]  Eve can impersonate any other user by exploiting the fact that the server does
    not keep track of which password, ticket pair belongs to each user. This would allow Eve to 
    create a connection with the server masquerading as any $ID_U$ for $U \in \{A,B,C,D\}$.
    \begin{enumerate}
      \item $E \longrightarrow S: ID_U, N_E$
      \item $S \longrightarrow E: C_S, \mathsf{Sign}_{S1}(ID_U || N_E)$
      \item $E \longrightarrow S: P_E, T_E$
    \end{enumerate}
    We could modify this protocol to prevent this attack by making the following switch:
    \begin{align}
      \text{Old Ticket}&:T_U = \mathsf{Sign}_S(H(P_U)) \nonumber \\
      \text{New Ticket}&:T_U = \mathsf{Sign}_S(H(P_U) || ID_U)  \nonumber 
    \end{align}
    This would allow the server to check each time if the password and the ID match up.
  \item[(b)]
    Eve can convince Bob that she is Alice by exploiting the fact that the User Authentication
    protocol is vulnerable to a Man In The Middle Attack, as shown below:
    \begin{enumerate}
      \item $E(``A") \longrightarrow B: C_A, N_E, ID_B  $ 
      \item $B\longrightarrow E(``A") : C_B, N_B, \mathsf{Sign}_B(N_E)  $ 
      \item $E \longrightarrow A: C_E, ID_A, N_B$
      \item $A \longrightarrow E: C_A, N_A, \mathsf{Sign}_A(N_B)$
      \item $E(``A") \longrightarrow B: \mathsf{Sign}_A(N_B)$ 
      \item $E \longrightarrow A: \mathsf{Sign}_E(N_A)$
    \end{enumerate}
    In this exchange, the $E, A$ authentication does not matter and is only used so $E$ can get 
    $B$'s nonce to send to $A$ to sign.
  \item[(c)]
    In this case, Steve, an eavesdropper, can convince the server that he is $A$ if he can 
    intercept the third stage of the Server login phase, as demonstrated below:
    \begin{enumerate}
      \item $A \longrightarrow S : ID_A, N_A$
      \item $S \longrightarrow A: C_S, \mathsf{Sign}_{S1}(ID_A || N_A)$
      \item $A \longrightarrow S: p_A, T_A$, here Steve can intercept this message, and 
        then login as shown below:
    \end{enumerate}
    Steve (``Alice'') Server Login:
    \begin{enumerate}
      \item $Steve(A) \longrightarrow S : ID_A, N_{Steve}$
      \item $S \longrightarrow A: C_S, \mathsf{Sign}_{S1}(ID_A || N_{Steve})$
      \item $Steve(A) \longrightarrow S: p_A, T_A$
    \end{enumerate}
  \item[(d)]
    In this case, Steve cannot exactly replicate the exploit of part (c), as he needs the user 
    password in order to encrypt the first message. However, if Steve can capture both the first 
    and the third step in the Server Login Phase, he can still identify himself to the server by 
    simply `replaying' or resending the messages. If he resends the first message (encrypted using
    $h2(p_u)$), and upon the server reply, he resends the third message, he can be authenticated 
    to the server. If the server happens to have mechanisms in place that check that the Nonce 
    generated in this first step of the authentication is `fresh', then Steve would have to 
    perform a more computationally intensive exploit. Because the hash function is not private, 
    and the input to the hash is a user-chosen password, Steve can use a dictionary / brute force
    attack on his captured third step of the authentication. Because the theoretical third step 
    would contain the following message: $\mathsf{Enc}_k(p_A, T_A)$, and the $k$ is determined by
    $h2(p_A)$, Steve can perform an attack by guessing $p_A$ and testing whether or not the $k$ 
    generated by this password can decrypt $\mathsf{Enc}_k(p_A, T_A)$ to reveal the $p$ he guessed.
    Now this attack is a lot more involved than the previous replay attack, but can still be done
    given the effectiveness of dictionary and brute force attacks against insecure user passwords.
  \item[(e)]
    The values $T_U$ and $VK_U$ would be appropriate inputs to the hash function as $T_U$
    is a signed hash already, making it not directly dependent on the user password. Additionally, 
    the $T_U$ used could be the modified $T_U$ from part (a) for additional security. $VK_U$ 
    additionally can be used as an input as it is created by a Key Signing algorithm rather than
    created by users, making it less predictable.
\end{itemize}

\pagebreak
\question{Cryptanalysis: The Two Time Pad} 
\begin{algorithm}
  \caption{Recover Plaintexts}
  \begin{algorithmic}
    \State{aaBytes $\leftarrow$ bytes(ciphertextaa)}
    \State{abBytes $\leftarrow$ bytes(ciphertextab)}
    \State{englishText $\leftarrow$ [A, ... ,Z, ' ', $\backslash0$ ]}
    \State{xordBytes $\leftarrow$ aaBytes $\oplus$ abBytes}
    \For{file in database}
    \State{fileBytes $\leftarrow$ bytes(file)}
    \State{testBytes $\leftarrow$ xordBytes $\oplus$ fileBytes}
    \For{character in file}
    \If{character not in englishText}
    \State{decrypt = false}
    \State{break}
    \EndIf
    \State{plaintextB += character}
    \EndFor
    \If{decrypt}
    \State{plaintextA $\leftarrow$ file}
    \EndIf
    \EndFor
    \State \Return{plaintextA, plaintextB}
  \end{algorithmic}
\end{algorithm}

\paragraph{Plaintext 1}
I SAW FIREWORKS FROM THE FREEWAY AND BEHIND CLOSED EYES I CANNOT MAKE THEM GO AWAY CAUSE YOU WERE BORN ON THE FOURTH OF JULY FREEDOM RING NOW SOMETHING ON THE SURFACE IT STINGS THAT SOMETHING ON THE SURFACE IT KIND OF MAKES ME NERVOUS WHO SAYS THAT YOU DESERVE THIS AND WHAT KIND OF GOD WOULD SERVE THIS WE WILL CURE THIS DIRTY OLD DISEASE IF YOUVE GOT THE POISON IVE GOT THE REMEDY THE REMEDY IS THE EXPERIENCE IT IS A DANGEROUS LIAISON I SAY THE COMEDY IS THAT ITS SERIOUS WHICH IS A STRANGE ENOUGH NEW PLAY ON WORDS I SAY THE TRAGEDY IS HOW YOURE GONNA SPEND THE REST OF YOUR NIGHTS WITH THE LIGHT ON SO SHINE THE LIGHT ON ALL OF YOUR FRIENDS BECAUSE IT ALL AMOUNTS TO NOTHING IN THE END I WONT WORRY MY LIFE AWAY I WONT WORRY MY LIFE AWAY I HEARD TWO MEN TALKING ON THE RADIO IN A CROSS FIRE KIND OF NEW REALITY SHOW UNCOVERING THE WAYS TO PLAN THE NEXT BIG ATTACK THEY WERE COUNTING DOWN THE DAYS TO STAB THE BROTHER IN THE BE RIGHT BACK AFTER THIS THE UNAVOIDABLE KISS WHERE THE MINTY FRESH DEATH BREATH IS SURE TO OUT

\paragraph{Plaintext 2}
DOOM WHETHER SHE MUST RETURN TO HER FATHERS HOME OR FOLLOW THE CHIEFTAINS TO THE LAND OF HELLAS NOW WHEN THE MAIDEN HAD MUSED UPON ALL THIS SHARP ANGUISH SHOOK HER HEART UNCEASINGLY AND QUICKLY SHE CALLED FORTH JASON ALONE APART FROM HIS COMRADES AND LED HIM ASIDE UNTIL THEY WERE FAR AWAY AND BEFORE HIS FACE UTTERED HER SPEECH ALL BROKEN WITH SOBS WHAT IS THIS PURPOSE THAT YE ARE NOW DEVISING ABOUT ME O SON OF AESON HAS THY TRIUMPH UTTERLY CAST FORGETFULNESS UPON THEE AND RECKEST THOU NOTHING OF ALL THAT THOU SPAKEST WHEN HELD FAST BY NECESSITY WHITHER ARE FLED THE OATHS BY ZEUS THE SUPPLIANTS GOD WHITHER ARE FLED THY HONIED PROMISES FOR WHICH IN NO SEEMLY WISE WITH SHAMELESS WILL I HAVE LEFT MY COUNTRY THE GLORIES OF MY HOME AND EVEN MY PARENTSTHINGS THAT WERE DEAREST TO ME AND FAR AWAY ALL ALONE I AM BORNE OVER THE SEA WITH THE PLAINTIVE KINGFISHERS BECAUSE OF THY TROUBLE IN ORDER THAT I MIGHT SAVE THY LIFE IN FULFILLING THE CONTESTS WITH THE OXEN AND THE EARTHBORN MEN LAST OF ALL THE FLEECEWHEN THE MATTER
%TODO: Uncomment!
% \printbibliography
\end{document}
